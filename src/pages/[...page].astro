---
import type { GetStaticPaths } from "astro";
import Pagination from "../components/control/Pagination.astro";
import PostPage from "../components/PostPage.astro";
import { PAGE_SIZE } from "../constants/constants";
import MainGridLayout from "../layouts/MainGridLayout.astro";
import { getSortedPosts } from "../utils/content-utils";

export const getStaticPaths = (async ({ paginate }) => {
	const allBlogPosts = await getSortedPosts();
	return paginate(allBlogPosts, { pageSize: PAGE_SIZE });
}) satisfies GetStaticPaths;

const { page } = Astro.props;

const len = page.data.length;
// å®šä¹‰æ–‡ç« æ•°é‡å˜é‡ï¼Œç”¨äºåœ¨CSSä¸­å®ç°é”™ä½åŠ¨ç”»
const postCount = len;
---

<!-- 
/**
 * ğŸ¨ æ¢¦ä¹‹æ³‰ä¸»é¢˜å’ŒåŠ¨ç”»æ ·å¼
 * ä½¿ç”¨ var(--hue) è‡ªåŠ¨é€‚é…ç”¨æˆ·åœ¨ settings-utils.ts ä¸­è®¾ç½®çš„ä¸»é¢˜è‰²è°ƒ
 */
-->
<style define:vars={{postCount}}>
    /* å®šä¹‰ä¸»é¢˜é¢œè‰²å˜é‡ï¼ŒåŸºäºç”¨æˆ·è®¾å®šçš„ --hue */
    :root {
        /* ä¸»è‰²è°ƒï¼Œä½¿ç”¨ HSL è°ƒæ•´äº®åº¦å’Œé¥±å’Œåº¦ */
        --theme-primary: hsl(var(--hue, 250) 80% 65%);
        --theme-secondary: hsl(var(--hue, 250) 60% 75%);
        --theme-accent: hsl(calc(var(--hue, 250) + 90) 80% 65%); /* å¼ºè°ƒè‰²ï¼Œè‰²ç›¸åç§» 90åº¦ */

        /* åŠ¨ç”»é…ç½® */
        --stagger-delay: 50ms; /* æ¯ä¸ªé¡¹ç›®å»¶è¿Ÿ 50ms */
    }
    
    /* -------------------- åŠ¨ç”»å®šä¹‰ -------------------- */

    @keyframes fadeInSlideUp {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* -------------------- ä¸»é¢˜ç¾åŒ– -------------------- */
    
    /* æ–‡ç« å¡ç‰‡å…¥åœºåŠ¨ç”» */
    /* * ğŸ¯ æ³¨æ„ï¼šä½ éœ€è¦ç¡®ä¿ PostPage.astro å†…éƒ¨çš„æ–‡ç« åˆ—è¡¨é¡¹ï¼ˆä¾‹å¦‚å¡ç‰‡ï¼‰
     * å…·æœ‰ .post-card-item ç±»åæ‰èƒ½è§¦å‘æ­¤åŠ¨ç”»ã€‚
     * ä¾‹å¦‚ï¼š<a href="..." class="post-card-item card-base ...">...</a>
     */
    .post-card-item {
        opacity: 0;
        animation: fadeInSlideUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        /* é”™ä½åŠ¨ç”»çš„å»¶è¿Ÿè®¡ç®— */
        animation-delay: calc(var(--content-delay) + var(--stagger-delay) * var(--post-index));
    }

    /* * ğŸ”® ç»ç’ƒæ‹Ÿæ€/è¾‰å…‰æ•ˆæœ (Glassmorphism/Glow)
     * åº”ç”¨åœ¨ card-base ç±»ä¸Šä»¥å¢å¼ºç¾æ„Ÿ
     */
    .card-base {
        position: relative;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
    }
    
    /* å¡ç‰‡æ‚¬åœæ•ˆæœï¼šè½»å¾®æŠ¬å‡å’Œä¸»é¢˜è‰²è¾‰å…‰ */
    .card-base:hover {
        transform: translateY(-5px);
        box-shadow: 0 0 30px var(--theme-primary);
        border-color: var(--theme-primary);
    }

    /* æ ‡é¢˜/å¼ºè°ƒæ–‡å­—ä½¿ç”¨ä¸»é¢˜è‰² */
    .post-card-title {
        color: var(--theme-primary);
        transition: color 0.3s ease;
    }
    
    /* åˆ†é¡µå¯¼èˆªæŒ‰é’®ç¾åŒ– */
    .pagination-button {
        background-color: var(--theme-primary);
        color: var(--color-background); /* ç¡®ä¿æ–‡å­—é¢œè‰²ä¸èƒŒæ™¯å½¢æˆè‰¯å¥½å¯¹æ¯” */
        border: none;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }
    .pagination-button:hover {
        background-color: var(--theme-accent);
        transform: translateY(-2px);
    }

</style>

<MainGridLayout>
    <!-- 
      ğŸš€ æ–‡ç« åˆ—è¡¨å®¹å™¨ï¼š 
      ä¸ºäº†å®ç°é”™ä½åŠ¨ç”»ï¼Œè¯·ç¡®ä¿ PostPage.astro å†…éƒ¨çš„æ¯ä¸ªæ–‡ç« å¡ç‰‡ï¼š
      1. å…·æœ‰ç±»å .post-card-item
      2. å…·æœ‰ style="--post-index: <ç´¢å¼•å·>" (ç´¢å¼•ä»0å¼€å§‹) 
      ä¾‹å¦‚ï¼š<a href="..." class="post-card-item" style="--post-index: 2;">...</a>
    -->
    <PostPage page={page}></PostPage>
    
    <!-- åˆ†é¡µç»„ä»¶åº”ç”¨ä¸»é¢˜æŒ‰é’®æ ·å¼ -->
    <Pagination class="mx-auto onload-animation pagination-button" page={page} style={`animation-delay: calc(var(--content-delay) + ${(len)*50}ms)`}></Pagination>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</MainGridLayout>